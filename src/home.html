<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Homepage</title>
    <meta name="author" content="Yuxuan Huang">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/responsive.css">
</head>
<body onload="testAuth()">
<!--------------Navigation--------------->
<nav>
    <div class="wrap-nav">
        <ul>
            <li><a href="#" style="color: white">Home</a></li>
            <li><a href="img_edit.html">PicEdit</a></li>
            <li id="login"><a href="login.html">Login</a></li>
            <li id="register"><a href="register.html">Register</a></li>
            <li style="cursor: pointer" id="logout" onclick="logout()"><a>Logout</a></li>
        </ul>
    </div>
</nav>

<!--------------Featured--------------->
<div class="featured">
    <div class="col-1-3">
        <img src="./img/home/featured1.jpg"/>
    </div>
    <div class="col-1-3 center">
        <img src="./img/home/featured2.jpg"/>
    </div>
    <div class="col-1-3">
        <img src="./img/home/featured3.jpg"/>
    </div>
    <div class="clear"></div>
</div>

<!--------------Content--------------->
<section id="content">
    <div id="main-content">
        <article>
            <div class="heading">
                <h2><a href="#">Sed accumsan libero quis mi commodo et suscipit enim lacinia</a></h2>
            </div>
            <div class="content">
                <img src="./img/home/img2.jpg"/>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam viverra convallis auctor. Sed
                    accumsan libero quis mi commodo et suscipit enim lacinia. Morbi rutrum vulputate est sed faucibus.
                    Nulla sed nisl mauris, id tristique tortor. Sed iaculis dapibus urna nec dictum. Proin non enim
                    odio. Proin vitae turpis libero, eget feugiat enim. Sed fringilla facilisis convallis.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam viverra convallis auctor. Sed
                    accumsan libero quis mi commodo et suscipit enim lacinia. Morbi rutrum vulputate est sed faucibus.
                    Nulla sed nisl mauris, id tristique tortor. Sed iaculis dapibus urna nec dictum. Proin non enim
                    odio.</p>
                <div class="info">Posted by Admin | December 01, 2012 | 01 Commnets
                    <div class="more"><a class="button" href="#">Read more</a></div>
                </div>
            </div>
        </article>
        <article>
            <div class="heading">
                <h2><a href="#">Sed accumsan libero quis mi commodo et suscipit enim lacinia</a></h2>
            </div>
            <div class="content">
                <img src="./img/home/img3.jpg"/>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam viverra convallis auctor. Sed
                    accumsan libero quis mi commodo et suscipit enim lacinia. Morbi rutrum vulputate est sed faucibus.
                    Nulla sed nisl mauris, id tristique tortor. Sed iaculis dapibus urna nec dictum. Proin non enim
                    odio. Proin vitae turpis libero, eget feugiat enim. Sed fringilla facilisis convallis.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam viverra convallis auctor. Sed
                    accumsan libero quis mi commodo et suscipit enim lacinia. Morbi rutrum vulputate est sed faucibus.
                    Nulla sed nisl mauris, id tristique tortor. Sed iaculis dapibus urna nec dictum. Proin non enim
                    odio.</p>
                <div class="info">Posted by Admin | December 01, 2012 | 01 Commnets
                    <div class="more"><a class="button" href="#">Read more</a></div>
                </div>
            </div>
        </article>
    </div>
    <div id="sidebar" class="col-right">
        <section>
            <div class="heading"><h2>About us</h2></div>
            <div class="content">
                <a href="#" target="_blank"><img src="./img/home/avenger.jpg"/></a>
                <p>Nick Fury of S.H.I.E.L.D. brings together a team of super humans to form The Avengers to help save
                    the Earth from Loki and his army.</p>
            </div>
        </section>
        <section>
            <div class="heading"><h2>Related Links</h2></div>
            <div class="content">
                <ul>
                    <li><a href="#">Avengers Detail Page</a></li>
                    <li><a href="#">Avengers news stories</a></li>
                    <li><a href="#">Avengers videos</a></li>
                    <li><a href="#">Avengers wallpapers</a></li>
                    <li><a href="#">Marvel's The Avengers</a></li>
                </ul>
            </div>
        </section>
        <section>
            <div class="heading"><h2>Avengers</h2></div>
            <div class="content">
                <div class="post">
                    <img src="./img/home/thumb1.jpg"/>
                    <h4><a href="#">Lorem ipsum dolor sit amet</a></h4>
                </div>
                <div class="post">
                    <img src="./img/home/thumb2.jpg"/>
                    <h4><a href="#">Lorem ipsum dolor sit amet</a></h4>
                </div>
                <div class="post">
                    <img src="./img/home/thumb3.jpg"/>
                    <h4><a href="#">Lorem ipsum dolor sit amet</a></h4>
                </div>
            </div>
        </section>
    </div>
    <div class="clear"></div>
</section>
<!--------------Footer--------------->
<footer>
    <div class="wrap-footer">
        <p>Copyright © Yuxuan Huang</p>
    </div>
</footer>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript">
    $.ajaxSetup({
        authError: function (callback) {
            刷新身份认证方法(function () {
                callback && callback();
            });
        }
    });

    function testAuth() {
        $.ajax({
            url: "http://127.0.0.1:3000/testAuth",
            type: "get",
            xhrFields: {
                withCredentials: true
            },
            success: function (res) {
                console.log(res.auth);
                if (res.auth) {
                    $("#login").css("display", "none");
                    $("#register").css("display", "none");
                    $("#logout").css("display", "inline")
                }
                else {
                    $("#logout").css("display", "none");
                    $("#login").css("display", "inline");
                    $("#register").css("display", "inline")
                }
            },
            error: function () {
                $("#logout").css("display", "none");
                $("#login").css("display", "inline");
                $("#register").css("display", "inline")
            }
        });
    }

    function logout() {
        $.ajax({
            url: "http://127.0.0.1:3000/logout",
            type: "get",
            xhrFields: {
                withCredentials: true
            },
            success: function (res) {
                if (!res.auth) {
                    alert("logout successfully!");
                    window.location.href = "login.html"
                }
                else {
                    alert("logout error!")
                }
            },
            error: function () {
                alert("logout error!")
            }
        });
    }
</script>

</body>
</html>